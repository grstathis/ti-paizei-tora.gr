<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Î£Î¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±Ï‚ â€“ Î¤Î±Î¹Î½Î¯ÎµÏ‚, Î©ÏÎ¬ÏÎ¹Î±, Î¤Î¹ Ï€Î±Î¯Î¶ÎµÎ¹ ÏƒÎ®Î¼ÎµÏÎ± & ÏƒÏ„Î¹Ï‚ ÎµÏ€ÏŒÎ¼ÎµÎ½ÎµÏ‚ 3 ÏÏÎµÏ‚</title>
  <meta name="description" content="Î”ÎµÏ‚ Ï„Î¹ Ï€Î±Î¯Î¶ÎµÎ¹ ÏƒÎ®Î¼ÎµÏÎ± ÏƒÏ„Î± ÏƒÎ¹Î½ÎµÎ¼Î¬ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚! ÎŸÎ´Î·Î³ÏŒÏ‚ Î³Î¹Î± ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï„Î±Î¹Î½Î¯ÎµÏ‚, ÏÏÎµÏ‚ Ï€ÏÎ¿Î²Î¿Î»ÏÎ½ ÎºÎ±Î¹ ÎºÎ¹Î½Î·Î¼Î±Ï„Î¿Î³ÏÎ¬Ï†Î¿Ï…Ï‚.">
  <meta name="keywords" content="ÏƒÎ¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±, Ï„Î±Î¹Î½Î¯ÎµÏ‚ Î‘Î¸Î®Î½Î±, Î¿Î´Î·Î³ÏŒÏ‚ ÏƒÎ¹Î½ÎµÎ¼Î¬, Ï€ÏÎ¿Î²Î¿Î»Î­Ï‚, Ï„Î¹ Ï€Î±Î¯Î¶ÎµÎ¹ ÏƒÎ®Î¼ÎµÏÎ±, ÎºÎ¹Î½Î·Î¼Î±Ï„Î¿Î³ÏÎ¬Ï†Î¿Î¹, Ï„Î±Î¹Î½Î¯ÎµÏ‚ ÏƒÎ®Î¼ÎµÏÎ±, Ï„Î¹ Ï€Î±Î¯Î¶ÎµÎ¹ Ï„ÏÏÎ±, athens cinema, athens movies, athens movie guide">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- âœ… Preload JSON for faster load -->
  <link rel="preload" href="movies.json" as="fetch" crossorigin>
  <link rel="preload" href="cinemas.json" as="fetch" crossorigin>

  <!-- âœ… Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Î£Î¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±Ï‚ â€“ Î¤Î±Î¹Î½Î¯ÎµÏ‚, ÎÏÎµÏ‚, Î¤Î¹ Î Î±Î¯Î¶ÎµÎ¹ Î£Î®Î¼ÎµÏÎ±">
  <meta property="og:description" content="Î”ÎµÏ‚ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï„Î±Î¹Î½Î¯ÎµÏ‚ Ï€Î¿Ï… Ï€Î±Î¯Î¶Î¿Ï…Î½ ÏƒÎ®Î¼ÎµÏÎ± ÏƒÏ„Î± ÏƒÎ¹Î½ÎµÎ¼Î¬ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚. ÎÏÎµÏ‚ Ï€ÏÎ¿Î²Î¿Î»ÏÎ½ ÎºÎ±Î¹ Î±Î¯Î¸Î¿Ï…ÏƒÎµÏ‚.">
  <meta property="og:url" content="https://ti-paizei-tora.gr">
  <meta property="og:image" content="https://ti-paizei-tora.gr/ti_paizei_tora_draw.png">

  <!-- âœ… Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Î£Î¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±Ï‚ â€“ ÎŸÎ´Î·Î³ÏŒÏ‚ Î¤Î±Î¹Î½Î¹ÏÎ½">
  <meta name="twitter:description" content="Î¤Î¹ Ï€Î±Î¯Î¶ÎµÎ¹ Ï„ÏÏÎ± ÎºÎ±Î¹ ÏƒÎ®Î¼ÎµÏÎ± ÏƒÏ„Î± ÏƒÎ¹Î½ÎµÎ¼Î¬ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚.">
  <meta name="twitter:image" content="https://ti-paizei-tora.gr/ti_paizei_tora_draw.png">

  <style>
  body {font-family: Arial, sans-serif; background:#fafafa; color:#222; margin:0; padding:1em;}
  h1 {text-align:center; margin-bottom:1em;}
  details {margin-bottom:1em; border:1px solid #ccc; border-radius:6px; background:#fff; flex:1; display:flex; flex-direction:column; overflow:hidden;}
  details[open] .scroll-box {max-height:30vh; overflow-y:auto;}
  summary {font-weight:bold; padding:0.5em; cursor:pointer; background:#f0f0f0; border-bottom:1px solid #ddd;}
  .scroll-box {overflow-y:auto; border:none; padding:0.5em; flex:1;}
  .checkbox-list {list-style:none; padding:0; margin:0;}
  .checkbox-list li {margin:0.2em 0;}
  .checkbox-list label {display:flex; align-items:center; cursor:pointer; background:#fff; border-radius:4px; padding:0.2em 0.4em; border:1px solid #eee;}
  .checkbox-list input {margin-right:6px;}
  .search-input {
  width: 100%;
  padding: 0.4em;
  margin-bottom: 0.4em;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: 0.9em;}
#filters-container {
  display: flex;
  flex-wrap: wrap;
  gap: 1em;
  justify-content: space-between;
  align-items: flex-start;
}

/* âœ… Each filter box (movies, cinemas, regions) side by side */
#filters-container details {
  flex: 1 1 calc(33.33% - 1em); /* three in a row */
  min-width: 260px;
  background: #fff;
  border: 1px solid #ccc;
  border-radius: 6px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* âœ… When closed, keep small height */
#filters-container details:not([open]) {
  min-height: 3.5em;
}

/* âœ… Responsive: stack vertically on small screens */
@media (max-width: 900px) {
  #filters-container details {
    flex: 1 1 calc(50% - 1em); /* two per row */
  }
}

@media (max-width: 600px) {
  #filters-container details {
    flex: 1 1 100%; /* one per row on mobile */
  }
}

  .movie {background:#fff; border-radius:8px; padding:1em; margin:1em 0; box-shadow:0 2px 4px rgba(0,0,0,0.1);}
  .cinema {margin-left:1.5em; color:#555;}
  a {color:#0055cc; text-decoration:none;}
  .filter-buttons {display:flex; justify-content:center; flex-wrap:wrap; gap:0.6em; margin-top:1.5em;}
  .filter-buttons button {border:none; border-radius:8px; padding:0.7em 1.4em; font-size:1em; cursor:pointer; transition:all 0.2s ease-in-out; font-weight:bold;}
  .filter-buttons button#todayBtn {background:#0078d7; color:white;}
  .filter-buttons button#todayBtn:hover {background:#005fa3;}
  .filter-buttons button#next3Btn {background:#ff9800; color:white;}
  .filter-buttons button#next3Btn:hover {background:#e68900;}
  .filter-buttons button#allBtn {background:#ddd;}
  .filter-buttons button#allBtn:hover {background:#ccc;}
  footer {text-align:center; margin-top:2em; color:#555; font-size:0.9em;}
  </style>
</head>
<body>
  <h1>ğŸ¬ Î£Î¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±Ï‚</h1>

  <div id="filters">
    <div id="filters-container">
      <!-- âœ… Region Filter (multi-select) -->
      <details open id="regionFilter">
        <summary>ğŸ“ Î•Ï€Î¹Î»Î¿Î³Î® Î ÎµÏÎ¹Î¿Ï‡Î®Ï‚</summary>
	    <input type="text" class="search-input" placeholder="Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Ï€ÎµÏÎ¹Î¿Ï‡Î®Ï‚..." oninput="filterList('regionCheckboxes', this.value)">
        <div class="scroll-box">
          <ul id="regionCheckboxes" class="checkbox-list"></ul>
        </div>
      </details>	

      <details open>
        <summary>ğŸ¬ Î•Ï€Î¹Î»Î¿Î³Î® Î¤Î±Î¹Î½Î¹ÏÎ½</summary>
		<input type="text" class="search-input" placeholder="Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Ï„Î±Î¹Î½Î¯Î±Ï‚..." oninput="filterList('movieCheckboxes', this.value)">
        <div class="scroll-box"><ul id="movieCheckboxes" class="checkbox-list"></ul></div>
      </details>

      <details open>
        <summary>ğŸ› Î•Ï€Î¹Î»Î¿Î³Î® ÎšÎ¹Î½Î·Î¼Î±Ï„Î¿Î³ÏÎ¬Ï†Ï‰Î½</summary>
		<input type="text" class="search-input" placeholder="Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÎºÎ¹Î½Î·Î¼Î±Ï„Î¿Î³ÏÎ¬Ï†Î¿Ï…..." oninput="filterList('cinemaCheckboxes', this.value)">
        <div class="scroll-box"><ul id="cinemaCheckboxes" class="checkbox-list"></ul></div>
      </details>


    </div>

    <div class="filter-buttons">
      <button id="allBtn" onclick="showAll()">ÎŒÎ»ÎµÏ‚ Î¿Î¹ Î ÏÎ¿Î²Î¿Î»Î­Ï‚</button>
      <button id="todayBtn" onclick="filterToday()">ğŸŸ Î¤Î¹ Î Î±Î¯Î¶ÎµÎ¹ Î£Î®Î¼ÎµÏÎ±</button>
      <button id="next3Btn" onclick="filterNext3()">â° Î•Ï€ÏŒÎ¼ÎµÎ½ÎµÏ‚ 3 ÎÏÎµÏ‚</button>
    </div>
  </div>

  <div id="results"></div>

  <footer>
    <p>Î£Î¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±Ï‚ Â© 2025 â€” ÎŸÎ´Î·Î³ÏŒÏ‚ ÎºÎ¹Î½Î·Î¼Î±Ï„Î¿Î³ÏÎ¬Ï†Ï‰Î½, Ï€ÏÎ¿Î²Î¿Î»ÏÎ½ ÎºÎ±Î¹ Ï„Î±Î¹Î½Î¹ÏÎ½ ÏƒÏ„Î·Î½ Î‘Î¸Î®Î½Î±.</p>
  </footer>

  <!-- âœ… Schema.org Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "MovieTheater",
    "name": "Î£Î¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±Ï‚",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Î‘Î¸Î®Î½Î±",
      "addressCountry": "GR"
    },
    "description": "Î Î»Î®ÏÎ·Ï‚ Î¿Î´Î·Î³ÏŒÏ‚ ÏƒÎ¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±Ï‚ Î¼Îµ ÏÏÎµÏ‚ Ï€ÏÎ¿Î²Î¿Î»ÏÎ½, Ï„Î±Î¹Î½Î¯ÎµÏ‚ ÎºÎ±Î¹ ÎºÎ¹Î½Î·Î¼Î±Ï„Î¿Î³ÏÎ¬Ï†Î¿Ï…Ï‚.",
    "url": "https://ti-paizei-tora.gr",
    "logo": "https://ti-paizei-tora.gr/ti_paizei_tora_logo.svg",
    "image": "https://ti-paizei-tora.gr/ti_paizei_tora_draw.png"
  }
  </script>

<script>
let moviesData = [];
let cinemasData = [];

// âœ… Dynamic title/meta updates
function updateMeta(title, description) {
  document.title = title;
  const descTag = document.querySelector('meta[name="description"]');
  if (descTag) descTag.setAttribute('content', description);
}

// âœ… Search filter function for dropdowns
function filterList(listId, query) {
  const list = document.getElementById(listId);
  const q = query.trim().toLowerCase();
  list.querySelectorAll('li').forEach(li => {
    const text = li.textContent.toLowerCase();
    li.style.display = text.includes(q) ? '' : 'none';
  });
}


async function loadData() {
  const [moviesRes, cinemasRes] = await Promise.all([
    fetch('movies.json'),
    fetch('cinemas.json')
  ]);
  moviesData = await moviesRes.json();
  cinemasData = await cinemasRes.json();

  populateCheckboxes();
  populateRegions();
  renderResults();
}

// âœ… Populate unique regions (checkbox list)
function populateRegions() {
  const allRegions = [...new Set(cinemasData.flat().map(c => c.region).filter(Boolean))].sort();
  const regionBox = document.getElementById('regionCheckboxes');
  regionBox.innerHTML = '';

  allRegions.forEach(region => {
    const li = document.createElement('li');
    li.innerHTML = `<label><input type="checkbox" value="${region}" onchange="renderResults()"> ${region}</label>`;
    regionBox.appendChild(li);
  });
}

// âœ… Movie + Cinema checkbox population
function populateCheckboxes() {
  const movieBox = document.getElementById('movieCheckboxes');
  movieBox.innerHTML = '';
  moviesData.forEach((m, i) => {
    const movie = m[0];
    const displayTitle = movie.original_title && movie.original_title.trim() !== ""
      ? `${movie.greek_title} (${movie.original_title})`
      : movie.greek_title;
    const li = document.createElement('li');
    li.innerHTML = `<label><input type="checkbox" value="${i}" onchange="renderResults()"> ${displayTitle}</label>`;
    movieBox.appendChild(li);
  });

  const allCinemas = [...new Set(cinemasData.flat(2).map(c => c.cinema))].sort();
  const cinemaBox = document.getElementById('cinemaCheckboxes');
  cinemaBox.innerHTML = '';
  allCinemas.forEach(name => {
    const li = document.createElement('li');
    li.innerHTML = `<label><input type="checkbox" value="${name}" onchange="renderResults()"> ${name}</label>`;
    cinemaBox.appendChild(li);
  });
}

// âœ… Main rendering logic
function renderResults(filteredList) {
  const results = document.getElementById('results');
  results.innerHTML = '';

  const selectedMovies = Array.from(document.querySelectorAll('#movieCheckboxes input:checked')).map(el => el.value);
  const selectedCinemas = Array.from(document.querySelectorAll('#cinemaCheckboxes input:checked')).map(el => el.value);
  const selectedRegions = Array.from(document.querySelectorAll('#regionCheckboxes input:checked')).map(el => el.value);

  const list = filteredList || cinemasData;

  list.forEach((movieCinemas, idx) => {
    if (selectedMovies.length && !selectedMovies.includes(String(idx))) return;

    const movie = moviesData[idx]?.[0];
    if (!movie) return;

    const validCinemas = movieCinemas.filter(c => c.timetable && c.timetable.flat().length > 0);
    const cinemasToShow = selectedCinemas.length
      ? validCinemas.filter(c => selectedCinemas.includes(c.cinema))
      : validCinemas;

    const regionFiltered = selectedRegions.length
      ? cinemasToShow.filter(c => selectedRegions.includes(c.region))
      : cinemasToShow;

    if (regionFiltered.length === 0) return;

    const displayTitle = movie.original_title && movie.original_title.trim() !== ""
      ? `${movie.greek_title} <span style="font-size:0.9em;color:#777;">(${movie.original_title})</span>`
      : movie.greek_title;

    const movieDiv = document.createElement('div');
    movieDiv.className = 'movie';
    movieDiv.innerHTML = `<h2><a href="${movie.athinorama_link}" target="_blank">${displayTitle}</a></h2>`;

    regionFiltered.forEach(cinema => {
      const timesList = cinema.timetable.flat().filter(t => t.trim() !== '');
      const sortedTimes = timesList.sort((a, b) => {
        const ta = (a.match(/(\d{2}):(\d{2})/) || []).slice(1);
        const tb = (b.match(/(\d{2}):(\d{2})/) || []).slice(1);
        return (parseInt(ta[0]) * 60 + parseInt(ta[1])) - (parseInt(tb[0]) * 60 + parseInt(tb[1]));
      });
      const formattedTimes = sortedTimes.map(t => {
        const match = t.match(/([Î‘-Î©Î±-Ï‰Î¬Î­Î¯ÏŒÎ®ÏÏÎ†ÎˆÎ‰ÎŠÎŒÎÎ]+)\s*(\d{1,2}\s*[Î‘-Î©Î±-Ï‰Î¬Î­Î¯ÏŒÎ®ÏÏÎ†ÎˆÎ‰ÎŠÎŒÎÎ]*)?\s*(\d{2}:\d{2})/);
        if (match) {
          const day = match[1]?.trim() || '';
          const datePart = match[2]?.trim() || '';
          const time = match[3];
          const fullDate = [day, datePart].filter(Boolean).join(' ');
          return `<span style="display:inline-block;margin:3px 6px;padding:4px 8px;background:#f5f5f5;border-radius:8px;">ğŸ•’ <strong>${time}</strong> â€” ${fullDate}</span>`;
        }
        return `<span style="display:inline-block;margin:3px 6px;padding:4px 8px;background:#f5f5f5;border-radius:8px;">${t}</span>`;
      }).join(' ');
      const c = document.createElement('div');
      c.className = 'cinema';
      c.innerHTML = `
        <h3>${cinema.cinema}</h3>
        <p>${cinema.address}</p>
        ${cinema.region ? `<div style="font-size:0.9em;color:#777;">ğŸ“ ${cinema.region}</div>` : ''}
        <div>${formattedTimes || '<em>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï€ÏÎ¿Î²Î¿Î»Î­Ï‚</em>'}</div>
      `;
      movieDiv.appendChild(c);
    });

    results.appendChild(movieDiv);
  });

  if (!results.hasChildNodes()) {
    results.innerHTML = '<p style="text-align:center;color:#666;">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼ÎµÏ‚ Ï€ÏÎ¿Î²Î¿Î»Î­Ï‚.</p>';
  }
}

// âœ… Filter buttons
function filterToday() {
  const now = new Date();
  const todayName = now.toLocaleDateString('el-GR', { weekday: 'long' });
  const nowMins = now.getHours() * 60 + now.getMinutes();

  const filtered = cinemasData.map(movie =>
    movie.map(cinema => {
      const newTimes = cinema.timetable.map(tt =>
        tt.filter(t => {
          if (!t.includes(todayName)) return false;
          const match = t.match(/(\d{2}):(\d{2})/);
          if (!match) return false;
          const mins = parseInt(match[1]) * 60 + parseInt(match[2]);
          return mins >= nowMins;
        })
      );
      return { ...cinema, timetable: newTimes };
    })
  );
  renderResults(filtered);
  highlightButton('todayBtn');
  updateMeta('Î¤Î¹ Î Î±Î¯Î¶ÎµÎ¹ Î£Î®Î¼ÎµÏÎ± ÏƒÏ„Î± Î£Î¹Î½ÎµÎ¼Î¬ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚ ğŸ¬','Î”ÎµÏ‚ Ï€Î¿Î¹ÎµÏ‚ Ï„Î±Î¹Î½Î¯ÎµÏ‚ Ï€Î±Î¯Î¶Î¿Î½Ï„Î±Î¹ ÏƒÎ®Î¼ÎµÏÎ± ÏƒÏ„Î± ÏƒÎ¹Î½ÎµÎ¼Î¬ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚ Î¼Îµ ÏÏÎµÏ‚ Ï€ÏÎ¿Î²Î¿Î»ÏÎ½ ÎºÎ±Î¹ Î±Î¯Î¸Î¿Ï…ÏƒÎµÏ‚.');
}

function filterNext3() {
  const now = new Date();
  const nowMins = now.getHours() * 60 + now.getMinutes();
  const next3 = nowMins + 180;
  const today = new Date().toLocaleDateString('el-GR', { weekday: 'long' });

  const filtered = cinemasData.map(movie =>
    movie.map(cinema => {
      const newTimes = cinema.timetable.map(tt => tt.filter(t => {
        if (!t.includes(today)) return false;
        const match = t.match(/(\d{2}):(\d{2})/);
        if (!match) return false;
        const mins = parseInt(match[1]) * 60 + parseInt(match[2]);
        return mins >= nowMins && mins <= next3;
      }));
      return { ...cinema, timetable: newTimes };
    })
  );
  renderResults(filtered);
  highlightButton('next3Btn');
  updateMeta('Î¤Î±Î¹Î½Î¯ÎµÏ‚ ÏƒÏ„Î¹Ï‚ Î•Ï€ÏŒÎ¼ÎµÎ½ÎµÏ‚ 3 ÎÏÎµÏ‚ ÏƒÏ„Î± Î£Î¹Î½ÎµÎ¼Î¬ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚ â°','Î‘Î½Î±ÎºÎ¬Î»Ï…ÏˆÎµ Ï€Î¿Î¹ÎµÏ‚ Ï„Î±Î¹Î½Î¯ÎµÏ‚ Ï€Î±Î¯Î¶Î¿Î½Ï„Î±Î¹ Î¼Î­ÏƒÎ± ÏƒÏ„Î¹Ï‚ ÎµÏ€ÏŒÎ¼ÎµÎ½ÎµÏ‚ 3 ÏÏÎµÏ‚ ÏƒÏ„Î± ÏƒÎ¹Î½ÎµÎ¼Î¬ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚.');
}

function showAll() {
  renderResults();
  highlightButton('allBtn');
  updateMeta('Î£Î¹Î½ÎµÎ¼Î¬ Î‘Î¸Î®Î½Î±Ï‚ â€“ ÎŒÎ»ÎµÏ‚ Î¿Î¹ Î¤Î±Î¹Î½Î¯ÎµÏ‚ & Î ÏÎ¿Î²Î¿Î»Î­Ï‚','ÎŸ Ï€Î»Î®ÏÎ·Ï‚ Î¿Î´Î·Î³ÏŒÏ‚ ÏƒÎ¹Î½ÎµÎ¼Î¬ Ï„Î·Ï‚ Î‘Î¸Î®Î½Î±Ï‚. Î”ÎµÏ‚ ÏŒÎ»ÎµÏ‚ Ï„Î¹Ï‚ Ï„Î±Î¹Î½Î¯ÎµÏ‚, ÏÏÎµÏ‚ Ï€ÏÎ¿Î²Î¿Î»ÏÎ½ ÎºÎ±Î¹ ÎºÎ¹Î½Î·Î¼Î±Ï„Î¿Î³ÏÎ¬Ï†Î¿Ï…Ï‚.');
}

function highlightButton(id) {
  document.querySelectorAll('.filter-buttons button').forEach(btn => btn.style.outline = 'none');
  const btn = document.getElementById(id);
  if (btn) btn.style.outline = '3px solid #222';
}

loadData();
</script>
</body>
</html>
